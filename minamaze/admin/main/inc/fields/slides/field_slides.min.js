jQuery(document).ready(function(){jQuery(".redux-slides-remove").live("click",function(){redux_change(jQuery(this));jQuery(this).parent().siblings().find('input[type="text"]').val("");jQuery(this).parent().siblings().find('input[type="hidden"]').val("");jQuery(this).parents().eq(3).slideUp("medium",function(){jQuery(this).remove();});});jQuery(".redux-slides-add").click(function(){var newSlide=jQuery(this).prev().find(".redux-slides-accordion-group:last").clone(true);var slideCount=jQuery(newSlide).find('input[type="text"]').attr("name").match(/\d+/);var slideCount1=slideCount*1+1;jQuery(newSlide).find('input[type="text"], input[type="hidden"], textarea').each(function(){jQuery(this).attr("name",jQuery(this).attr("name").replace(/\d+/,slideCount1)).attr("id",jQuery(this).attr("id").replace(/\d+/,slideCount1));jQuery(this).val("");if(jQuery(this).hasClass("slide-sort")){jQuery(this).val(slideCount1);}});jQuery(newSlide).find(".screenshot").removeAttr("style");jQuery(newSlide).find(".screenshot").addClass("hide");jQuery(newSlide).find(".screenshot a").attr("href","");jQuery(newSlide).find(".remove-image").addClass("hide");jQuery(newSlide).find(".redux-slides-image").attr("src","").removeAttr("id");jQuery(newSlide).find("h3").text("").append('<span class="redux-slides-header">New slide</span><span class="ui-accordion-header-icon ui-icon ui-icon-plus"></span>');jQuery(this).prev().append(newSlide);});jQuery(".slide-title").keyup(function(event){newTitle=event.target.value;jQuery(this).parents().eq(3).find(".redux-slides-header").text(newTitle);});jQuery(function(){jQuery("#redux-slides-accordion").accordion({header:"> div > h3",collapsible:true,active:false,heightStyle:"content",icons:{header:"ui-icon-plus",activeHeader:"ui-icon-minus"}}).sortable({axis:"y",handle:"h3",stop:function(event,ui){ui.item.children("h3").triggerHandler("focusout");var inputs=jQuery("input.slide-sort");inputs.each(function(idx){jQuery(this).val(idx);});}});});function redux_add_file(event,selector){var frame;var $el=jQuery(this);event.preventDefault();if(frame){frame.open();return;}frame=wp.media({multiple:false,library:{type:"image"},title:$el.data("choose"),button:{text:$el.data("update")}});frame.on("select",function(){var attachment=frame.state().get("selection").first();frame.close();if(attachment.attributes.type!=="image"){return;}selector.find(".upload").val(attachment.attributes.url);selector.find(".upload-id").val(attachment.attributes.id);selector.find(".upload-height").val(attachment.attributes.height);selector.find(".upload-width").val(attachment.attributes.width);if(attachment.attributes.type==="image"){selector.find(".screenshot").empty().hide().append('<img class="redux-slides-image" src="'+attachment.attributes.url+'">').slideDown("fast");}selector.find(".remove-image").removeClass("hide");selector.find(".redux-background-properties").slideDown();});frame.open();}function redux_remove_file(selector){if(!selector.find(".remove-image").addClass("hide")){return;}selector.find(".remove-image").addClass("hide");selector.find(".upload").val("");selector.find(".upload-id").val("");selector.find(".upload-height").val("");selector.find(".upload-width").val("");selector.find(".redux-background-properties").hide();var screenshot=selector.find(".screenshot");screenshot.slideUp();selector.find(".remove-file").unbind();if(jQuery(".section-upload .upload-notice").length>0){jQuery(".media_upload_button").remove();}}jQuery(".remove-image, .remove-file").unbind("click").click(function(){redux_remove_file(jQuery(this).parents().eq(2));});jQuery(".media_upload_button").unbind("click").click(function(event){redux_add_file(event,jQuery(this).parents().eq(2));});});