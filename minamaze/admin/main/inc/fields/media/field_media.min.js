/* global redux_change, wp */jQuery(document).ready(function(e){function t(t,n){var r,i=e(this);t.preventDefault();if(r){r.open();return}r=wp.media({multiple:!1,library:{type:"image"},title:i.data("choose"),button:{text:i.data("update")}}),r.on("select",function(){var e=r.state().get("selection").first();r.close();if(e.attributes.type!=="image")return;n.find(".upload").val(e.attributes.url),n.find(".upload-id").val(e.attributes.id),n.find(".upload-height").val(e.attributes.height),n.find(".upload-width").val(e.attributes.width),e.attributes.type==="image"&&!n.find(".upload").hasClass("noPreview")&&n.find(".screenshot").empty().hide().append('<img class="redux-option-image" src="'+e.attributes.url+'">').slideDown("fast"),n.find(".media_upload_button").unbind(),n.find(".remove-image").removeClass("hide"),n.find(".redux-background-properties").slideDown()}),r.open()}function n(t){if(!t.find(".remove-image").addClass("hide"))return;redux_change(jQuery("#"+t.attr("rel"))),t.find(".remove-image").addClass("hide"),t.find(".upload").val(""),t.find(".upload-id").val(""),t.find(".upload-height").val(""),t.find(".upload-width").val(""),t.find(".redux-background-properties").hide();var n=t.find(".screenshot");n.slideUp(),t.find(".remove-file").unbind(),e(".section-upload .upload-notice").length>0&&e(".media_upload_button").remove()}e(".remove-image, .remove-file").on("click",function(){n(e(this).parents("td")),redux_change(e(this).parents("td:first").find(".upload"))}),e(".media_upload_button").unbind("click").click(function(n){t(n,e(this).parents("td")),redux_change(e(this).parents("td:first").find(".upload"))})});